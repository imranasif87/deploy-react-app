import{b as r,j as e,C as se,c as a,B as f,L as oe,K as M,e as le,n as ce}from"./index-04fc7d56.js";import{M as z}from"./Modal-200beab9.js";/* empty css                     *//* empty css                  */import{T as de}from"./TextField-b77e99c3.js";import{S as k}from"./Stack-83892a09.js";import{A as T}from"./Alert-0bf56b7a.js";import{T as he,b as D,c as l,a as me}from"./TableRow-ccfcb366.js";import{T as pe}from"./TableHead-be2f99d0.js";import{T as C}from"./TableSortLabel-1fd7be73.js";import{E as ue,D as ge}from"./Edit-be4598f8.js";import{I as h}from"./Input-3dc7ac4d.js";import"./OutlinedInput-ed327864.js";import"./InputBase-d61b863a.js";import"./Select-2f2e7d44.js";const N=10,Pe=fe=>{const[b,I]=r.useState([]),[F,P]=r.useState([]),[u,W]=r.useState("asc"),[_,H]=r.useState(""),[m,w]=r.useState(0),[s,R]=r.useState(null),[c,B]=r.useState({flight:{flightNumber:"",flightId:""},person:{firstName:"",lastName:"",email:"",phone:""},type:1,isConfirmed:!1}),[J,v]=r.useState(!1),[Q,g]=r.useState(!1),y=t=>{const{name:n,value:o}=t.target;B(p=>({...p,person:{...p.person,[n]:o}}))},G=t=>{B(n=>({...n,flight:{...n.flight,flightNumber:t.target.value}}))},[K,O]=r.useState(!1),[Z,$]=r.useState(!1),[U,E]=r.useState(!1),[V,X]=r.useState(localStorage.getItem("language")||"no"),d=V==="en"?le.soulList:ce.soulList,Y=t=>{X(t),localStorage.setItem("language",t)};r.useEffect(()=>{async function t(){try{const x=(await(await fetch("https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Soul")).json()).filter(i=>i.type===1).map(i=>i.flight?{id:i.id,flightNumber:i.flight.flightNumber,firstName:i.person.firstName,lastName:i.person.lastName,phone:i.person.phone}:{id:i.id,flightNumber:"",firstName:i.person.firstName,lastName:i.person.lastName,phone:i.person.phone});I(x)}catch(n){console.error("Error while fetching soul data:",n)}}t()},[]),r.useEffect(()=>{b.length>0&&P(b)},[b]);const S=t=>{const n=[...F].sort((o,p)=>u==="asc"?o[t]>p[t]?1:-1:o[t]<p[t]?1:-1);P(n),W(u==="asc"?"desc":"asc")},ee=t=>{const{value:n}=t.target;H(n),w(0)},L=F.filter(t=>t.firstName&&t.firstName.toLowerCase().includes(_.toLowerCase())),q=Math.ceil(L.length/N),te=m===0,ae=m===q-1,j=L.slice(m*N,m*N+N),ne=async t=>{if(window.confirm("Er du sikker pÃ¥ at du vil slette ansatt?"))try{await fetch(`https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Soul/${t}`,{method:"DELETE"}),I(b.filter(o=>o.id!==t)),O(!0)}catch(o){console.error("Error while deleting soul:",o)}},re=async t=>{t.preventDefault();try{const n=c.flightNumber,x=(await(await fetch("https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Flight")).json())[0].id;console.log(x),(await fetch(`https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/flight/${x}/soul`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({person:{firstName:c.person.firstName,lastName:c.person.lastName,email:c.person.email,phone:c.person.phone},type:1,isConfirmed:!1})})).ok?(console.log("Soul added successfully"),g(!1),setTimeout(()=>{window.location.reload()},3e3),E(!0)):(console.error("Error adding Soul"),g(!1),setTimeout(()=>{window.location.reload()},3e3),E(!0))}catch(n){console.error("Error adding Soul:",n)}},ie=async t=>{g(!0)},A=async t=>{const n=await fetch(`https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Soul/${t}`).then(o=>o.json());R(n),$(!0),v(!0),console.log(JSON.stringify(n))};return e(se,{navHeader:d.title,onLanguageChange:Y,children:a("div",{className:"SearchField",children:[e(de,{label:d.search,variant:"outlined",onChange:ee}),e(f,{className:"add-crew",onClick:()=>ie(),variant:"contained",style:{position:"absolute",top:"17%",right:"2%",width:"250px",height:"54px",margin:2,backgroundColor:"#369E3B"},sx:{":hover":{backgroundColor:"#369E3B"},margin:1},children:"Legg til ansatt"}),K&&e(k,{sx:{width:"97%",position:"centered",margin:"20px"},spacing:2,children:e(T,{severity:"success",onClose:()=>O(!1),children:"Ansatt slettet!"})}),Z&&e(k,{sx:{width:"97%",position:"centered",margin:"20px"},spacing:2,children:e(T,{severity:"success",onClose:()=>$(!1),children:"Opplysningene til ansatt ble endret"})}),U&&e(k,{sx:{width:"97%",position:"centered",margin:"20px"},spacing:2,children:e(T,{severity:"success",onClose:()=>E(!1),children:"Ansatt ble lagt inn"})}),a("div",{className:"IncidentTable",children:[a(he,{children:[e(pe,{children:a(D,{children:[e(l,{children:e(C,{active:!0,direction:u,onClick:()=>S("firstName"),children:a("h3",{children:[" ",d.firstName," "]})})}),e(l,{children:e(C,{active:!0,direction:u,onClick:()=>S("lastName"),children:a("h3",{children:[" ",d.lastName," "]})})}),e(l,{children:e(C,{active:!0,direction:u,onClick:()=>S("flightNumber"),children:a("h3",{children:[" ",d.flight," "]})})}),e(l,{children:e(C,{active:!0,direction:u,children:a("h3",{children:[" ",d.phone," "]})})}),e(l,{})]})}),e(me,{children:j.length>0?j.map(t=>a(D,{component:oe,to:`/SoulInformation/${t.id}`,children:[e(l,{children:t.firstName}),e(l,{children:t.lastName}),e(l,{children:t.flightNumber}),e(l,{children:t.phone}),a(l,{children:[e(M,{onClick:()=>A(t.id),children:e(ue,{})}),e(M,{"aria-label":"delete",color:"secondary",onClick:()=>ne(t.id),children:e(ge,{})})]})]},t.id)):e(D,{children:a(l,{colSpan:4,children:[d.notFound,"."]})})}),L.length>N&&a("div",{className:"Buttons",children:[e("button",{disabled:te,onClick:()=>w(m-1),children:d.previous}),a("span",{children:[d.page,` ${m+1} av ${q}`]}),e("button",{disabled:ae,onClick:()=>w(m+1),children:d.next})]})]}),a(z,{className:"my-modal",modalHeadLine:"Endre opplysninger",isOpen:J,onClose:()=>v(!1),children:[e("h2",{}),a("div",{className:"container",children:[a("div",{children:[e("label",{htmlFor:"soul-firstName",children:"Fornavn"}),e("br",{}),e(h,{className:"input-form",id:"soul-firstName",name:"soul-firstName",type:"text",placeholder:s==null?void 0:s.person.firstName,onChange:t=>onChange(t),pattern:"^([\\p{L}\\p{P}\\d+](\\s)?){2,31}$",maxLength:31,style:{width:"450px"},required:!0})]}),a("div",{children:[e("label",{htmlFor:"soul-firstName",children:"Etternavn"}),e("br",{}),e(h,{className:"input-form",id:"soul-firstName",name:"soul-firstName",type:"text",placeholder:s==null?void 0:s.person.lastName,onChange:t=>onChange(t,/^([\p{L}\p{P}\d+](\s)?){2,31}$/),maxLength:31,style:{width:"450px"},required:!0})]}),a("div",{children:[e("label",{htmlFor:"soul-firstName",children:"E-post"}),e("br",{}),e(h,{className:"input-form",id:"soul-firstName",name:"soul-firstName",type:"text",placeholder:s==null?void 0:s.person.email,onChange:t=>onChange(t),pattern:"^([\\p{L}\\p{P}\\d+](\\s)?){2,31}$",maxLength:31,style:{width:"450px"},required:!0})]}),a("div",{children:[e("label",{htmlFor:"soul-firstName",children:"Telefon"}),e("br",{}),e(h,{className:"input-form",id:"soul-firstName",name:"soul-firstName",type:"text",placeholder:s==null?void 0:s.person.phone,onChange:t=>onChange(t),pattern:"^([\\p{L}\\p{P}\\d+](\\s)?){2,31}$",maxLength:31,style:{width:"450px"},required:!0})]})]}),a("div",{className:"btn-container",children:[e(f,{className:"change-btn",type:"submit",form:"ic-form__affected",variant:"contained",style:{backgroundColor:"#369E3B",width:"230px",height:"40px"},onSubmit:A,children:"Endre opplysninger"}),e(f,{className:"back-btn",type:"submit",form:"ic-form__affected",variant:"contained",style:{backgroundColor:"#369E3B",width:"230px",height:"40px"},onClick:()=>v(!1),children:"Tilbake"})]})]}),e(z,{className:"my-modal",modalHeadLine:"Legg til ansatt",isOpen:Q,onClose:()=>g(!1),children:e("div",{className:"container",children:a("form",{onSubmit:re,children:[a("label",{children:["First Name:",e(h,{type:"text",name:"firstName",value:c.person.firstName,onChange:y,maxLength:31,style:{width:"450px"},required:!0})]}),a("label",{children:["Last Name:",e(h,{type:"text",name:"lastName",value:c.person.lastName,onChange:y,maxLength:31,style:{width:"450px"},required:!0})]}),a("label",{children:["Email:",e(h,{type:"email",name:"email",value:c.person.email,onChange:y,maxLength:31,style:{width:"450px"},required:!0})]}),a("label",{children:["Phone:",e(h,{type:"tel",name:"phone",value:c.person.phone,onChange:y,maxLength:31,style:{width:"450px"},required:!0})]}),a("label",{children:["Flight Number:",e(h,{type:"text",name:"flightNumber",value:c.flight.flightNumber,onChange:G,maxLength:31,style:{width:"450px"},required:!0})]}),a("div",{className:"btn-container",children:[e(f,{type:"submit",className:"change-btn",variant:"contained",style:{backgroundColor:"#369E3B",width:"230px",height:"40px"},children:"Legg til ansatt"}),e(f,{className:"back-btn",type:"submit",variant:"contained",style:{backgroundColor:"#369E3B",width:"230px",height:"40px"},onClick:()=>g(!1),children:"Tilbake"})]})]})})})]})]})})};export{Pe as default};
