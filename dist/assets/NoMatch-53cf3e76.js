import{b as r,j as e,C as W,c as a,K as T,e as G,n as K}from"./index-04fc7d56.js";/* empty css                     */import{T as O}from"./TextField-b77e99c3.js";import{S as b}from"./Stack-83892a09.js";import{A as S}from"./Alert-0bf56b7a.js";import{T as Z,b as w,c as i,a as _}from"./TableRow-ccfcb366.js";import{T as q}from"./TableHead-be2f99d0.js";import{T as f}from"./TableSortLabel-1fd7be73.js";import{E as J,D as U}from"./Edit-be4598f8.js";import"./OutlinedInput-ed327864.js";import"./InputBase-d61b863a.js";import"./Select-2f2e7d44.js";import"./Input-3dc7ac4d.js";const h=10,he=V=>{const[m,E]=r.useState([]),[u,v]=r.useState([]),[d,k]=r.useState("asc"),[D,L]=r.useState(""),[o,g]=r.useState(0),[A,P]=r.useState(localStorage.getItem("language")||"no"),s=A==="en"?G.noMatch:K.noMatch,I=t=>{P(t),localStorage.setItem("language",t)},[j,x]=r.useState(!1),[F,M]=r.useState(!1),[B,$]=r.useState(!1);r.useEffect(()=>{async function t(){try{const p=(await(await fetch("https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Affected")).json()).map(n=>n.flight?{id:n.id,flightNumber:n.flight.flightNumber,firstName:n.person.firstName,lastName:n.person.lastName,phone:n.person.phone,isConfirmed:n.isConfirmed}:{id:n.id,flightNumber:"",firstName:n.person.firstName,lastName:n.person.lastName,phone:n.person.phone,isConfirmed:n.isConfirmed});E(p)}catch(c){console.error("Error while fetching affected data:",c)}}t()},[]),r.useEffect(()=>{m.length>0&&v(m)},[m]);const C=t=>{const c=[...u].sort((l,p)=>d==="asc"?l[t]>p[t]?1:-1:l[t]<p[t]?1:-1);v(c),k(d==="asc"?"desc":"asc")},z=t=>{const{value:c}=t.target;L(c),g(0)},N=u.filter(t=>t.firstName.toLowerCase().includes(D.toLowerCase())&&!t.isConfirmed),y=Math.ceil(u.length/h),H=o===0,Q=o===y-1;u.slice(o*h,o*h+h);const R=async t=>{if(window.confirm("Er du sikker på at du vil slette ansatt?"))try{await fetch(`https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Affected/${t}`,{method:"DELETE"}),E(m.filter(l=>l.id!==t)),x(!0)}catch(l){console.error("Error while deleting affected:",l)}};return e(W,{navHeader:s.title,onLanguageChange:I,children:a("div",{className:"SearchField",children:[e(O,{label:s.search,variant:"outlined",onChange:z}),j&&e(b,{sx:{width:"95%",position:"centered",margin:"20px"},spacing:2,children:e(S,{severity:"success",onClose:()=>x(!1),children:"Pårørende slettet!"})}),F&&e(b,{sx:{width:"95%",position:"centered",margin:"20px"},spacing:2,children:e(S,{severity:"success",onClose:()=>M(!1),children:"Opplysningene til pårørende ble endret"})}),B&&e(b,{sx:{width:"95%",position:"centered",margin:"20px"},spacing:2,children:e(S,{severity:"success",onClose:()=>$(!1),children:"Pårørende ble lagt inn"})}),e("div",{className:"IncidentTable",children:a(Z,{children:[e(q,{children:a(w,{children:[e(i,{children:e(f,{active:!0,direction:d,onClick:()=>C("firstName"),children:a("h3",{children:[" ",s.firstName," "]})})}),e(i,{children:e(f,{active:!0,direction:d,onClick:()=>C("lastName"),children:a("h3",{children:[" ",s.lastName," "]})})}),e(i,{children:e(f,{active:!0,direction:d,onClick:()=>C("flightNumber"),children:a("h3",{children:[" ",s.flight," "]})})}),e(i,{children:e(f,{active:!0,direction:d,children:a("h3",{children:[" ",s.phone," "]})})}),e(i,{})]})}),e(_,{children:N.length>0?N.map(t=>a(w,{children:[e(i,{children:t.firstName}),e(i,{children:t.lastName}),e(i,{children:t.flightNumber}),e(i,{children:t.phone}),a(i,{children:[e(T,{"aria-label":"edit",onClick:()=>onEditRow(row,index),children:e(J,{})}),e(T,{"aria-label":"delete",color:"secondary",onClick:()=>R(t.id),children:e(U,{})})]})]},t.id)):e(w,{children:e(i,{colSpan:4,children:"Fant ingen ansatte."})})}),N.length>h&&a("div",{className:"Buttons",children:[e("button",{disabled:H,onClick:()=>g(o-1),children:s.previous}),a("span",{children:[s.page,` ${o+1} av ${y}`]}),e("button",{disabled:Q,onClick:()=>g(o+1),children:s.next})]})]})})]})})};export{he as default};
