import{b as o,u as q,d as H,j as e,F as _,c as n,C as M,B as h,L as z,e as R,n as W}from"./index-04fc7d56.js";import{M as $}from"./Modal-200beab9.js";/* empty css                     *//* empty css                  */import{S as C}from"./Stack-83892a09.js";import{A as N}from"./Alert-0bf56b7a.js";import{T as J,a as K,b as m,c}from"./TableRow-ccfcb366.js";import{I as s}from"./Input-3dc7ac4d.js";import"./InputBase-d61b863a.js";const ne=P=>{var y,x;const[T,w]=o.useState(localStorage.getItem("language")||"no"),r=T==="en"?R.incident:W.incident,k=t=>{w(t),localStorage.setItem("language",t)},[A,u]=o.useState(!1),[S,f]=o.useState(!1),E=q(),[l,p]=o.useState({id:0,flightNumber:"",description:""}),[I,d]=o.useState(!1),[a,F]=o.useState(null),{id:g}=H(),O=t=>{fetch(`https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Incident/${t}`).then(i=>i.json()).then(i=>{p({id:i.id,createdAt:i.createdAt,timeOfIncident:i.timeOfIncident,flightNumber:i.flightNumber,flight:{id:i.flight.id,origin:i.flight.origin,departureTime:i.flight.departureTime,destination:i.flight.destination,arrivalTime:i.flight.arrivalTime,seatCapacity:i.flight.seatCapacity,price:i.flight.price,airline:i.flight.airline},description:i.description,airlineName:i.flight.airline,departureTime:i.flight.departureTime,arrivalTime:i.flight.arrivalTime,isActive:i.isActive})})};o.useEffect(()=>{O(g)},[g]);const v=t=>new Date(t).toLocaleDateString("nb-NO"),L=()=>{d(!0)},B=async t=>{const i=await fetch(`https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Incident/${t}`).then(D=>D.json());F(i),u(!0),d(!0),console.log(JSON.stringify(i))},[U,b]=o.useState(l.isActive),j=()=>{if(b(!1),p(t=>({...t,isActive:!1})),window.confirm("Are you sure you want to deactivate the incident?")){const t={...l,isActive:!1};fetch(`https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Incident/${g}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(i=>{if(!i.ok)throw new Error("Failed to update the incident");f(!0),setTimeout(()=>{E("/historicalincidents")},3e3)}).catch(i=>{console.error(i)})}else b(!0),p(t=>({...t,isActive:!0}))};return e(_,{children:n(M,{navHeader:"Test",onLanguageChange:k,children:[e(h,{className:"add-crew",onClick:()=>L(),variant:"contained",style:{position:"absolute",top:"17%",right:"1%",width:"250px",height:"54px",margin:2,backgroundColor:"#369E3B"},sx:{":hover":{backgroundColor:"#369E3B"},margin:1},children:r.changeIncident}),l.isActive&&e(h,{className:"deactivate-incident",onClick:j,variant:"contained",style:{position:"absolute",top:"17%",left:"1%",width:"250px",height:"54px",margin:2,backgroundColor:"#FF0000"},sx:{":hover":{backgroundColor:"#FF0000"},margin:1},children:r.deactivate}),e("div",{className:"App",children:n("header",{className:"App-header",children:[e("h1",{children:r.incident}),A&&e(C,{sx:{width:"97%",position:"centered",margin:"20px"},spacing:2,children:e(N,{severity:"success",onClose:()=>u(!1),children:"Opplysningene til ansatt ble endret"})}),S&&e(C,{sx:{width:"97%",position:"centered",margin:"20px"},spacing:2,children:e(N,{severity:"success",onClose:()=>f(!1),children:"Hendelse ble deaktivert"})}),e(J,{children:n(K,{children:[n(m,{children:[n(c,{children:["ID: ",l.id]}),n(c,{children:[r.flight,": ",l.flightNumber||"Null"]})]}),n(m,{children:[n(c,{children:[r.origin,": ",((y=l.flight)==null?void 0:y.origin)||"Null"]}),n(c,{children:[r.destination,": ",((x=l.flight)==null?void 0:x.destination)||"Null"]})]}),n(m,{children:[n(c,{children:[r.departure,": ",v(l.departureTime)]}),n(c,{children:[r.arrival,": ",v(l.arrivalTime)]})]}),n(m,{children:[e(c,{children:r.description}),e(c,{children:l.description})]})]})}),n($,{className:"my-modal",modalHeadLine:r.changeIncident,isOpen:I,onClose:()=>d(!1),children:[e("h2",{}),n("div",{className:"container",children:[n("div",{children:[e("label",{htmlFor:"incident-time",children:r.timeOfIncident}),e("br",{}),e(s,{className:"input-form",id:"incident-time",name:"timeOfIncident",type:"text",placeholder:a==null?void 0:a.timeOfIncident,onChange:t=>onChange(t),style:{width:"450px"},required:!0})]}),n("div",{children:[e("label",{htmlFor:"flight-number",children:r.flight}),e("br",{}),e(s,{className:"input-form",id:"flight-number",name:"flightNumber",type:"text",placeholder:a==null?void 0:a.flightNumber,onChange:t=>onChange(t),style:{width:"450px"},required:!0})]}),n("div",{children:[e("label",{htmlFor:"description",children:r.description}),e("br",{}),e(s,{className:"input-form",id:"description",name:"description",type:"text",placeholder:a==null?void 0:a.description,onChange:t=>onChange(t),style:{width:"450px"},required:!0})]}),n("div",{children:[e("label",{htmlFor:"departure-time",children:r.departure}),e("br",{}),e(s,{className:"input-form",id:"departure-time",name:"departureTime",type:"text",placeholder:a==null?void 0:a.departureTime,onChange:t=>onChange(t),style:{width:"450px"},required:!0})]}),n("div",{children:[e("label",{htmlFor:"arrival-time",children:r.arrival}),e("br",{}),e(s,{className:"input-form",id:"arrival-time",name:"arrivalTime",type:"text",placeholder:a==null?void 0:a.arrivalTime,onChange:t=>onChange(t),style:{width:"450px"},required:!0})]})]}),n("div",{className:"btn-container",children:[e(h,{className:"change-btn",type:"submit",form:"ic-form__affected",variant:"contained",style:{backgroundColor:"#369E3B",width:"230px",height:"40px"},onSubmit:B,children:r.changeIncident}),e(h,{className:"back-btn",type:"submit",form:"ic-form__affected",variant:"contained",style:{backgroundColor:"#369E3B",width:"230px",height:"40px"},onClick:()=>d(!1),children:r.back})]})]}),e(z,{to:"/HRK_controlpanel",children:r.back})]})})]})})};export{ne as default};
