import{a,j as e,C as E,L as P,e as O,n as B}from"./index-bb811758.js";/* empty css                     */import{T as F}from"./TextField-2ebea9c3.js";import{T as G,b as j,c as s,a as H}from"./TableRow-6e0748be.js";import{T as $}from"./TableHead-9379f5c4.js";import{T as x}from"./TableSortLabel-22828496.js";import"./OutlinedInput-f4cb9bb1.js";import"./InputBase-2c8f6ab4.js";import"./Select-a03c26b5.js";import"./Input-7ae70adb.js";const h=10,V=Q=>{const[m,I]=a.useState([]),[p,b]=a.useState([]),[o,C]=a.useState("asc"),[A,L]=a.useState(""),[r,f]=a.useState(0),[T,w]=a.useState(localStorage.getItem("language")||"no"),n=T==="en"?O.incident:B.incident,y=t=>{w(t),localStorage.setItem("language",t)};let v=[];a.useEffect(()=>{async function t(){try{const d=await(await fetch("https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Incident")).json();console.log(d);const c=d.map(l=>({id:l.id,flight:{flightNumber:l.flightNumber},createdAt:new Date(l.createdAt).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}).replace(/\//g,"."),timeOfIncident:new Date(l.timeOfIncident).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}).replace(/\//g,"."),description:l.description,isActive:l.isActive}));I(c),v=c,console.log(c[0].isActive,c[1].isActive,c[2].isActive)}catch(i){console.error("Error while fetching incident data:",i)}}t()},[]),a.useEffect(()=>{m.length>0&&b(m)},[m]);const g=t=>{const i=[...v].sort((d,c)=>o==="asc"?d[t]>c[t]?1:-1:d[t]<c[t]?1:-1);b(i),C(o==="asc"?"desc":"asc")},N=t=>{const{value:i}=t.target;L(i),f(0)},u=p.slice(r*h,r*h+h);u.filter(t=>t.flight.flightNumber&&t.flight.flightNumber.toLowerCase().includes(A.toLowerCase()));const S=Math.ceil(p.length/h),D=r===0,k=r===S-1;return e.jsx(E,{navHeader:n.historicalIncidents,onLanguageChange:y,children:e.jsxs("div",{className:"SearchField",children:[e.jsx(F,{label:n.search,variant:"outlined",onChange:N}),e.jsx("div",{className:"IncidentTable",children:e.jsxs(G,{children:[e.jsx($,{children:e.jsxs(j,{children:[e.jsx(s,{children:e.jsx(x,{active:!0,direction:o,onClick:()=>g("createdAt"),children:e.jsxs("h3",{children:[" ",n.createdAt," "]})})}),e.jsx(s,{children:e.jsx(x,{active:!0,direction:o,onClick:()=>g("flightNumber"),children:e.jsxs("h3",{children:[" ",n.flight," "]})})}),e.jsx(s,{children:e.jsx(x,{active:!0,direction:o,onClick:()=>g("timeOfIncident"),children:e.jsxs("h3",{children:[" ",n.timeOfIncident," "]})})}),e.jsx(s,{style:{width:"450px"},children:e.jsx(x,{active:!0,direction:o,onClick:()=>g("description"),children:e.jsxs("h3",{children:[" ",n.description," "]})})})]})}),e.jsxs(H,{children:[u.filter(t=>!t.isActive).map(t=>{var i;return e.jsxs(j,{component:P,to:`/Incident/${t.id}`,children:[e.jsx(s,{children:t.createdAt}),e.jsx(s,{children:((i=t.flight)==null?void 0:i.flightNumber)||"Null"}),e.jsx(s,{children:t.timeOfIncident}),e.jsx(s,{component:"div",children:t.description})]},t.id)}),u.filter(t=>t).length===0&&e.jsx(j,{children:e.jsxs(s,{colSpan:4,children:[" ",n.notFound]})})]}),u.length>h&&e.jsxs("div",{className:"Buttons",children:[e.jsx("button",{disabled:D,onClick:()=>f(r-1),children:n.previous}),e.jsxs("span",{children:[n.page,` ${r+1} av ${S}`]}),e.jsx("button",{disabled:k,onClick:()=>f(r+1),children:n.next})]})]})})]})})};export{V as default};
