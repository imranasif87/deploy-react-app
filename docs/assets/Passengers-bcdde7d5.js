import{c as ae,j as e,a as i,u as re,C as ie,B as N,I as _,e as oe,n as le}from"./index-bb811758.js";import{M as O}from"./Modal-f29f3020.js";/* empty css                  *//* empty css                     */import{T as ce}from"./TextField-2ebea9c3.js";import{S as L}from"./Stack-3358c896.js";import{A as P}from"./Alert-e5bc2dbf.js";import{T as de,b as T,c as o,a as he}from"./TableRow-6e0748be.js";import{T as pe}from"./TableHead-9379f5c4.js";import{T as g}from"./TableSortLabel-22828496.js";import{E as me,D as ue}from"./Edit-9b26e8c6.js";import{I as h}from"./Input-7ae70adb.js";import"./OutlinedInput-f4cb9bb1.js";import"./InputBase-2c8f6ab4.js";import"./Select-a03c26b5.js";const xe=ae(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"}),"Info"),y=10,De=ge=>{const[f,F]=i.useState([]),[b,w]=i.useState([]),[p,$]=i.useState("asc"),[fe,q]=i.useState(""),[u,C]=i.useState(0),[z,v]=i.useState(!1),[M,j]=i.useState(!1),[t,A]=i.useState({id:0,flightNumber:"",person_FirstName:"",person_LastName:"",person_Email:"",person_Phone:"",type:0,isConfirmed:!1}),W=re(),[a,I]=i.useState({flight:{flightNumber:"",flightId:""},person:{firstName:"",lastName:"",email:"",phone:""},type:0,isConfirmed:!1}),[V,H]=i.useState(localStorage.getItem("language")||"no"),l=V==="en"?oe.soulList:le.soulList,R=s=>{H(s),localStorage.setItem("language",s)};i.useEffect(()=>{async function s(){try{const c=(await(await fetch("https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Soul")).json()).filter(d=>d.type===0).map(d=>({id:d.id,person_FirstName:d.person.firstName,person_LastName:d.person.lastName,person_Email:d.person.email,person_Phone:d.person.phone,flightNumber:d.flight.flightNumber}));F(c)}catch(n){console.error("Error while fetching passengers data:",n)}}s()},[]),i.useEffect(()=>{f.length>0&&w(f)},[f]);const x=s=>{const n=[...b].sort((r,c)=>p==="asc"?r[s]>c[s]?1:-1:r[s]<c[s]?1:-1);w(n),$(p==="asc"?"desc":"asc")},m=s=>{const{name:n,value:r}=s.target;I(c=>({...c,person:{...c.person,[n]:r}}))},J=s=>{I(n=>({...n,flight:{...n.flight,flightNumber:s.target.value}}))},[Q,D]=i.useState(!1),[G,E]=i.useState(!1),[U,S]=i.useState(!1),B=Math.ceil(b.length/y),Z=u===0,K=u===B-1,k=b.slice(u*y,u*y+y),X=s=>{const{value:n}=s.target;q(n),C(0);let r=[];n!==""?r=b.filter(c=>c.person_FirstName&&c.person_FirstName.toLowerCase().includes(n.toLowerCase())):r=f,w(r)},Y=async s=>{if(window.confirm("Er du sikker pÃ¥ at du vil slette passasjer?"))try{await fetch(`https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Soul/${s}`,{method:"DELETE"}),F(f.filter(r=>r.id!==s)),D(!0)}catch(r){console.error("Error while deleting soul:",r)}},ee=async s=>{s.preventDefault();try{const n=a.flight.flightNumber,d=(await(await fetch("https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Flight")).json())[0].id;console.log(d),(await fetch(`https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/flight/${d}/soul`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({person:{firstName:a.person.firstName,lastName:a.person.lastName,email:a.person.email,phone:a.person.phone},type:0,isConfirmed:!1})})).ok?(console.log("Soul added successfully"),j(!1),setTimeout(()=>{window.location.reload()},3e3),S(!0)):(console.error("Error adding Soul"),j(!1),setTimeout(()=>{window.location.reload()},3e3),S(!0))}catch(n){console.error("Error adding Soul:",n)}},se=async s=>{s.preventDefault();try{a.person.firstName!==""&&(t.person_FirstName=a.person.firstName),a.person.lastName!==""&&(t.person_LastName=a.person.lastName),a.person.email!==""&&(t.person_Email=a.person.email),a.person.phone!==""&&(t.person_Phone=a.person.phone),(await fetch(`https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Soul/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({person:{firstName:t.person_FirstName,lastName:t.person_LastName,email:t.person_Email,phone:t.person_Phone},type:t.type,isConfirmed:t.isConfirmed})})).ok?(console.log("Soul updated successfully"),v(!1),setTimeout(()=>{window.location.reload()},3e3),E(!0)):(console.error("Error editing Soul"),j(!1),setTimeout(()=>{window.location.reload()},3e3),E(!0))}catch(n){console.error("Error editing Soul:",n)}},te=async()=>{j(!0)},ne=async s=>{const n=await fetch(`https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Soul/${s}`).then(r=>r.json());A(n),v(!0),console.log(JSON.stringify(n))};return e.jsx(ie,{navHeader:l.passengers,onLanguageChange:R,children:e.jsxs("div",{className:"SearchField",children:[e.jsx(ce,{label:l.searchPassengers,variant:"outlined",onChange:X}),e.jsx(N,{className:"add-crew",onClick:()=>te(),variant:"contained",style:{position:"absolute",top:"17%",right:"2%",width:"250px",height:"54px",margin:2,backgroundColor:"#369E3B"},sx:{":hover":{backgroundColor:"#369E3B"},margin:1},children:"Legg til passasjer"}),Q&&e.jsx(L,{sx:{width:"97%",position:"centered",margin:"20px"},spacing:2,children:e.jsx(P,{severity:"success",onClose:()=>D(!1),children:"Ansatt slettet!"})}),G&&e.jsx(L,{sx:{width:"97%",position:"centered",margin:"20px"},spacing:2,children:e.jsx(P,{severity:"success",onClose:()=>E(!1),children:"Opplysningene til ansatt ble endret"})}),U&&e.jsx(L,{sx:{width:"97%",position:"centered",margin:"20px"},spacing:2,children:e.jsx(P,{severity:"success",onClose:()=>S(!1),children:"Ansatt ble lagt inn"})}),e.jsxs("div",{className:"IncidentTable",children:[e.jsxs(de,{children:[e.jsx(pe,{children:e.jsxs(T,{children:[e.jsx(o,{children:e.jsx(g,{active:!0,direction:p,onClick:()=>x("id"),children:e.jsx("h3",{children:"Id "})})}),e.jsx(o,{children:e.jsx(g,{active:!0,direction:p,onClick:()=>x("flightNumber"),children:e.jsxs("h3",{children:[" ",l.flight]})})}),e.jsx(o,{children:e.jsx(g,{active:!0,direction:p,onClick:()=>x("person_FirstName"),children:e.jsxs("h3",{children:[" ",l.firstName," "]})})}),e.jsx(o,{children:e.jsx(g,{active:!0,direction:p,onClick:()=>x("person_LastName"),children:e.jsxs("h3",{children:[" ",l.lastName," "]})})}),e.jsx(o,{children:e.jsx(g,{active:!0,direction:p,onClick:()=>x("person_Email"),children:e.jsxs("h3",{children:[" ",l.email," "]})})}),e.jsx(o,{children:e.jsx(g,{active:!0,direction:p,onClick:()=>x("person_Phone"),children:e.jsxs("h3",{children:[" ",l.phone," "]})})}),e.jsx(o,{})]})}),e.jsx(he,{children:k.length>0?k.map(s=>e.jsxs(T,{children:[e.jsx(o,{children:s.id}),e.jsx(o,{children:s.flightNumber}),e.jsx(o,{children:s.person_FirstName}),e.jsx(o,{children:s.person_LastName}),e.jsx(o,{children:s.person_Email}),e.jsx(o,{children:s.person_Phone}),e.jsxs(o,{children:[e.jsx(_,{onClick:()=>ne(s.id),children:e.jsx(me,{})}),e.jsx(_,{"aria-label":"delete",color:"secondary",onClick:()=>Y(s.id),children:e.jsx(ue,{})}),e.jsx(_,{"aria-label":"detail",color:"secondary",onClick:()=>W(`/SoulInformation/${s.id}`),children:e.jsx(xe,{})})]})]},s.id)):e.jsx(T,{children:e.jsx(o,{colSpan:4,children:l.noPassengers})})}),k.length>y&&e.jsxs("div",{className:"Buttons",children:[e.jsx("button",{disabled:Z,onClick:()=>C(u-1),children:l.previous}),e.jsxs("span",{children:[l.page,` ${u+1} av ${B}`]}),e.jsx("button",{disabled:K,onClick:()=>C(u+1),children:l.next})]})]}),e.jsxs(O,{modalHeadLine:"Endre opplysninger",isOpen:z,children:[e.jsx("h2",{}),e.jsxs("form",{onSubmit:se,children:[e.jsxs("div",{className:"container",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"firstName",children:"Fornavn"}),e.jsx("br",{}),e.jsx(h,{className:"input-form",name:"firstName",type:"text",defaultValue:t==null?void 0:t.person_FirstName,onChange:m,inputProps:{pattern:"^([p{L}p{P}d+](s)?){2,31}$",required:!0},style:{width:"450px"}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"lastName",children:"Etternavn"}),e.jsx("br",{}),e.jsx(h,{className:"input-form",name:"lastName",type:"text",defaultValue:t==null?void 0:t.person_LastName,onChange:m,style:{width:"450px"},required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",children:"E-post"}),e.jsx("br",{}),e.jsx(h,{className:"input-form",name:"email",type:"text",defaultValue:t==null?void 0:t.person_Email,onChange:m,inputProps:{pattern:"^([p{L}p{P}d+](s)?){2,31}$",required:!0},style:{width:"450px"}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",children:"Telefon"}),e.jsx("br",{}),e.jsx(h,{className:"input-form",name:"phone",type:"text",defaultValue:t==null?void 0:t.person_Phone,onChange:m,inputProps:{pattern:"^([p{L}p{P}d+](s)?){2,31}$",required:!0},style:{width:"450px"}})]})]}),e.jsxs("div",{className:"btn-container",children:[e.jsx(N,{className:"change-btn",type:"submit",variant:"contained",style:{backgroundColor:"#369E3B",width:"230px",height:"40px"},children:"Endre opplysninger"}),e.jsx(N,{className:"back-btn",type:"submit",variant:"contained",style:{backgroundColor:"#369E3B",width:"230px",height:"40px"},onClick:()=>v(!1),children:"Tilbake"})]})]})]}),e.jsx(O,{modalHeadLine:"Legg til passasjer",isOpen:M,children:e.jsx("div",{className:"container",children:e.jsxs("form",{onSubmit:ee,children:[e.jsxs("label",{children:["First Name:",e.jsx(h,{type:"text",name:"firstName",value:a.person.firstName,onChange:m,style:{width:"450px"},required:!0})]}),e.jsxs("label",{children:["Last Name:",e.jsx(h,{type:"text",name:"lastName",value:a.person.lastName,onChange:m,style:{width:"450px"},required:!0})]}),e.jsxs("label",{children:["Email:",e.jsx(h,{type:"email",name:"email",value:a.person.email,onChange:m,style:{width:"450px"},required:!0})]}),e.jsxs("label",{children:["Phone:",e.jsx(h,{type:"tel",name:"phone",value:a.person.phone,onChange:m,style:{width:"450px"},required:!0})]}),e.jsxs("label",{children:["Flight Number:",e.jsx(h,{type:"text",name:"flightNumber",value:a.flight.flightNumber,onChange:J,style:{width:"450px"},required:!0})]}),e.jsxs("div",{className:"btn-container",children:[e.jsx(N,{type:"submit",className:"change-btn",variant:"contained",style:{backgroundColor:"#369E3B",width:"230px",height:"40px"},children:"Legg til ansatt"}),e.jsx(N,{className:"back-btn",type:"submit",variant:"contained",style:{backgroundColor:"#369E3B",width:"230px",height:"40px"},onClick:()=>j(!1),children:"Tilbake"})]})]})})})]})]})})};export{De as default};
