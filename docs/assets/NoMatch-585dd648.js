import{a as n,j as e,C as G,I as y,e as O,n as Z}from"./index-0d061a6e.js";/* empty css                     */import{T as _}from"./TextField-78e03c0c.js";import{S as j}from"./Stack-fb4fdbd4.js";import{A as C}from"./Alert-bcfbf7f1.js";import{T as q,b as N,c as r,a as J}from"./TableRow-1bd3958f.js";import{T as K}from"./TableHead-d0cb991a.js";import{T as x}from"./TableSortLabel-8fc85edf.js";import{E as U,D as V}from"./Edit-e7bc14d1.js";import"./OutlinedInput-022772fb.js";import"./InputBase-2dce6e5c.js";import"./Select-afcd75d4.js";import"./Input-6bc773cf.js";const h=10,me=X=>{const[m,b]=n.useState([]),[u,S]=n.useState([]),[l,T]=n.useState("asc"),[k,D]=n.useState(""),[o,f]=n.useState(0),[A,L]=n.useState(localStorage.getItem("language")||"no"),a=A==="en"?O.noMatch:Z.noMatch,I=s=>{L(s),localStorage.setItem("language",s)},[P,w]=n.useState(!1),[F,M]=n.useState(!1),[B,R]=n.useState(!1);let E=[];n.useEffect(()=>{async function s(){try{const d=(await(await fetch("https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Affected")).json()).map(t=>t.flight?{id:t.id,flightNumber:t.flight.flightNumber,firstName:t.person.firstName,lastName:t.person.lastName,phone:t.person.phone,isConfirmed:t.isConfirmed}:{id:t.id,flightNumber:"",firstName:t.person.firstName,lastName:t.person.lastName,phone:t.person.phone,isConfirmed:t.isConfirmed});b(d),E=d}catch(i){console.error("Error while fetching affected data:",i)}}s()},[]),n.useEffect(()=>{m.length>0&&S(m)},[m]);const p=s=>{const i=[...E].sort((c,d)=>l==="asc"?c[s]>d[s]?1:-1:c[s]<d[s]?1:-1);S(i),T(l==="asc"?"desc":"asc")},$=s=>{const{value:i}=s.target;D(i),f(0)},g=u.filter(s=>s.firstName.toLowerCase().includes(k.toLowerCase())&&!s.isConfirmed),v=Math.ceil(u.length/h),z=o===0,H=o===v-1;u.slice(o*h,o*h+h);const Q=async s=>{if(window.confirm("Er du sikker på at du vil slette ansatt?"))try{await fetch(`https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Affected/${s}`,{method:"DELETE"}),b(m.filter(c=>c.id!==s)),w(!0)}catch(c){console.error("Error while deleting affected:",c)}},W=(s,i)=>{};return e.jsx(G,{navHeader:a.title,onLanguageChange:I,children:e.jsxs("div",{className:"SearchField",children:[e.jsx(_,{label:a.search,variant:"outlined",onChange:$}),P&&e.jsx(j,{sx:{width:"95%",position:"centered",margin:"20px"},spacing:2,children:e.jsx(C,{severity:"success",onClose:()=>w(!1),children:"Pårørende slettet!"})}),F&&e.jsx(j,{sx:{width:"95%",position:"centered",margin:"20px"},spacing:2,children:e.jsx(C,{severity:"success",onClose:()=>M(!1),children:"Opplysningene til pårørende ble endret"})}),B&&e.jsx(j,{sx:{width:"95%",position:"centered",margin:"20px"},spacing:2,children:e.jsx(C,{severity:"success",onClose:()=>R(!1),children:"Pårørende ble lagt inn"})}),e.jsx("div",{className:"IncidentTable",children:e.jsxs(q,{children:[e.jsx(K,{children:e.jsxs(N,{children:[e.jsx(r,{children:e.jsx(x,{active:!0,direction:l,onClick:()=>p("firstName"),children:e.jsxs("h3",{children:[" ",a.firstName," "]})})}),e.jsx(r,{children:e.jsx(x,{active:!0,direction:l,onClick:()=>p("lastName"),children:e.jsxs("h3",{children:[" ",a.lastName," "]})})}),e.jsx(r,{children:e.jsx(x,{active:!0,direction:l,onClick:()=>p("flightNumber"),children:e.jsxs("h3",{children:[" ",a.flight," "]})})}),e.jsx(r,{children:e.jsx(x,{active:!0,direction:l,children:e.jsxs("h3",{children:[" ",a.phone," "]})})}),e.jsx(r,{})]})}),e.jsx(J,{children:g.length>0?g.map(s=>e.jsxs(N,{children:[e.jsx(r,{children:s.firstName}),e.jsx(r,{children:s.lastName}),e.jsx(r,{children:s.flightNumber}),e.jsx(r,{children:s.phone}),e.jsxs(r,{children:[e.jsx(y,{"aria-label":"edit",onClick:()=>W(),children:e.jsx(U,{})}),e.jsx(y,{"aria-label":"delete",color:"secondary",onClick:()=>Q(s.id),children:e.jsx(V,{})})]})]},s.id)):e.jsx(N,{children:e.jsx(r,{colSpan:4,children:"Fant ingen ansatte."})})}),g.length>h&&e.jsxs("div",{className:"Buttons",children:[e.jsx("button",{disabled:z,onClick:()=>f(o-1),children:a.previous}),e.jsxs("span",{children:[a.page,` ${o+1} av ${v}`]}),e.jsx("button",{disabled:H,onClick:()=>f(o+1),children:a.next})]})]})})]})})};export{me as default};
