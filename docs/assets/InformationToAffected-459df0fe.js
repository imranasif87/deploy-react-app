import{a as c,j as e,B as R,e as D,n as w,A as E,C as A,L as y}from"./index-0d061a6e.js";import{T as b}from"./TextField-78e03c0c.js";/* empty css                     */import{T as L,b as m,c as n,a as N}from"./TableRow-1bd3958f.js";import{T as P}from"./TableHead-d0cb991a.js";import"./OutlinedInput-022772fb.js";import"./InputBase-2dce6e5c.js";import"./Select-afcd75d4.js";import"./Input-6bc773cf.js";const _=j=>{const{formData:d,onChange:h,onSubmit:l}=j,{FlightId:p,Description:f}=d,[o,g]=c.useState(localStorage.getItem("language")||"no"),a=o==="en"?D.incident:w.incident,r=u=>{g(u),localStorage.setItem("language",u)};return e.jsx("div",{onChange:r,children:e.jsxs("div",{className:"login-form",children:[e.jsx("div",{children:e.jsx("h1",{children:a.uploadPressRelease})}),e.jsxs("form",{className:"form__login",onSubmit:l,children:[e.jsxs("div",{className:"form__login__column",children:[e.jsx("label",{htmlFor:"FlightId",children:a.flightId}),e.jsx("br",{}),e.jsx(b,{style:{width:"300px"},className:"input-email",id:"FlightId",name:"FlightId",type:"text",placeholder:a.flightId,onChange:h,value:p,required:!0})]}),e.jsxs("div",{className:"form__login__column",children:[e.jsx("label",{htmlFor:"Description",children:a.description}),e.jsx("br",{}),e.jsx(b,{style:{width:"300px"},className:"input-password",id:"Description",name:"Description",placeholder:a.description,onChange:h,value:f,type:"text",required:!0})]}),e.jsx(R,{type:"submit",variant:"contained",style:{width:"300px",border:"1px solid white",color:"white",backgroundColor:"#00602C"},sx:{":hover":{backgroundColor:"#369E3B"},margin:1},children:a.submit})]})]})})},k={FlightId:0,Description:""},J=j=>{const[d,h]=c.useState([]),[l,p]=c.useState({FlightId:0,Description:""}),{setIsAuthenticated:f,user:o}=c.useContext(E),[g,a]=c.useState(localStorage.getItem("language")||"no"),r=g==="en"?D.incident:w.incident,u=s=>{a(s),localStorage.setItem("language",s)},x=()=>{fetch("https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/PressRelease/").then(s=>s.json()).then(s=>{h(s)})};c.useEffect(()=>{x()},[]);const C=s=>{const{name:t,value:i}=s.target;p(S=>({...S,[t]:i}))},I=async s=>{s.preventDefault(),console.log(l),await F(l.FlightId,l.Description),p(k)},T=(s,t)=>{t.preventDefault(),confirm("Are you sure?")&&v(s)},v=async s=>{const t=await fetch(`https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/PressRelease/${s}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(t.status===200)x();else{if(t.status===404)return!1;throw new Error("Unexpected error occurred")}},F=async(s,t)=>{const i=await fetch(`https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/PressRelease/${s}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({description:t})});if(i.status===200)x();else{if(i.status===404)return!1;throw new Error("Unexpected error occurred")}};return e.jsxs(A,{navHeader:r.informationToAffected,onLanguageChange:u,children:[e.jsx("div",{className:"App",children:e.jsxs("header",{className:"App-header",children:[e.jsx("h1",{children:r.informationToAffected}),o&&o.role==="0"?e.jsx(_,{formData:l,onChange:C,onSubmit:I}):"",e.jsxs(L,{children:[e.jsx(P,{children:e.jsxs(m,{children:[e.jsx(n,{children:e.jsx("h3",{children:"ID"})}),e.jsx(n,{children:e.jsx("h3",{children:r.flight})}),e.jsx(n,{children:e.jsx("h3",{children:r.description})}),e.jsx(n,{children:e.jsx("h3",{children:r.createdAt})}),o&&o.role==="0"?e.jsx(n,{}):""]})}),e.jsx(N,{children:d.length>0?d.map(s=>{var t;return e.jsxs(m,{component:y,to:`/pressrelease/${s.id}`,children:[e.jsx(n,{children:s.id}),e.jsx(n,{children:(t=s.flight)==null?void 0:t.flightNumber}),e.jsx(n,{component:"div",children:s.description}),e.jsx(n,{children:new Date(s.createdAt).toLocaleDateString("en-GB")}),o.role==="0"?e.jsx(n,{children:e.jsxs("span",{style:{cursor:"pointer",color:"red"},onClick:i=>T(s.id,i),children:[r.delete," "]})}):""]},s.id)}):e.jsx(m,{children:e.jsxs(n,{colSpan:4,children:[r.notFound,"."]})})})]})]})}),e.jsx(y,{to:"/test",children:r.back})]})};export{J as default};
