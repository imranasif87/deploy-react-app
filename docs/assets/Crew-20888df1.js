import{a,j as e,C as re,B as g,L as oe,I as A,e as le,n as ce}from"./index-0d061a6e.js";import{M}from"./Modal-6024edb1.js";/* empty css                     *//* empty css                  */import{T as de}from"./TextField-78e03c0c.js";import{S}from"./Stack-fb4fdbd4.js";import{A as k}from"./Alert-bcfbf7f1.js";import{T as he,b as L,c as o,a as pe}from"./TableRow-1bd3958f.js";import{T as me}from"./TableHead-d0cb991a.js";import{T as b}from"./TableSortLabel-8fc85edf.js";import{E as ue,D as fe}from"./Edit-e7bc14d1.js";import{I as d}from"./Input-6bc773cf.js";import"./OutlinedInput-022772fb.js";import"./InputBase-2dce6e5c.js";import"./Select-afcd75d4.js";const j=10,Ie=xe=>{const[f,T]=a.useState([]),[z,D]=a.useState([]),[u,W]=a.useState("asc"),[_,H]=a.useState(""),[p,y]=a.useState(0),[n,R]=a.useState(null),[l,P]=a.useState({id:0,flight:{flightNumber:"",flightId:""},person:{firstName:"",lastName:"",email:"",phone:""},type:1,isConfirmed:!1}),[J,I]=a.useState(!1),[Q,N]=a.useState(!1),h=t=>{const{name:s,value:r}=t.target;P(m=>({...m,person:{...m.person,[s]:r}}))},G=t=>{P(s=>({...s,flight:{...s.flight,flightNumber:t.target.value}}))},[Z,F]=a.useState(!1),[K,B]=a.useState(!1),[U,w]=a.useState(!1),[V,X]=a.useState(localStorage.getItem("language")||"no"),c=V==="en"?le.soulList:ce.soulList,Y=t=>{X(t),localStorage.setItem("language",t)};let C=[];a.useEffect(()=>{async function t(){try{const x=(await(await fetch("https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Soul")).json()).filter(i=>i.type===1).map(i=>i.flight?{id:i.id,flightNumber:i.flight.flightNumber,firstName:i.person.firstName,lastName:i.person.lastName,phone:i.person.phone}:{id:i.id,flightNumber:"",firstName:i.person.firstName,lastName:i.person.lastName,phone:i.person.phone});T(x),C=x}catch(s){console.error("Error while fetching soul data:",s)}}t()},[]),a.useEffect(()=>{f.length>0&&(D(f),C=f)},[f]);const v=t=>{const s=[...C].sort((r,m)=>u==="asc"?r[t]>m[t]?1:-1:r[t]<m[t]?1:-1);D(s),W(u==="asc"?"desc":"asc")},ee=t=>{const{value:s}=t.target;H(s),y(0)},E=z.filter(t=>t.firstName&&t.firstName.toLowerCase().includes(_.toLowerCase())),O=Math.ceil(E.length/j),te=p===0,se=p===O-1,$=E.slice(p*j,p*j+j),ne=async t=>{if(window.confirm("Er du sikker pÃ¥ at du vil slette ansatt?"))try{await fetch(`https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Soul/${t}`,{method:"DELETE"}),T(f.filter(r=>r.id!==t)),F(!0)}catch(r){console.error("Error while deleting soul:",r)}},ae=async t=>{t.preventDefault();try{const s=l.flight.flightNumber,x=(await(await fetch("https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Flight")).json())[0].id;console.log(x),(await fetch(`https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/flight/${x}/soul`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({person:{firstName:l.person.firstName,lastName:l.person.lastName,email:l.person.email,phone:l.person.phone},type:1,isConfirmed:!1})})).ok?(console.log("Soul added successfully"),N(!1),setTimeout(()=>{window.location.reload()},3e3),w(!0)):(console.error("Error adding Soul"),N(!1),setTimeout(()=>{window.location.reload()},3e3),w(!0))}catch(s){console.error("Error adding Soul:",s)}},ie=async()=>{N(!0)},q=async t=>{const s=await fetch(`https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Soul/${t}`).then(r=>r.json());R(s),B(!0),I(!0),console.log(JSON.stringify(s))};return e.jsx(re,{navHeader:c.title,onLanguageChange:Y,children:e.jsxs("div",{className:"SearchField",children:[e.jsx(de,{label:c.search,variant:"outlined",onChange:ee}),e.jsx(g,{className:"add-crew",onClick:()=>ie(),variant:"contained",style:{position:"absolute",top:"17%",right:"2%",width:"250px",height:"54px",margin:2,backgroundColor:"#369E3B"},sx:{":hover":{backgroundColor:"#369E3B"},margin:1},children:"Legg til ansatt"}),Z&&e.jsx(S,{sx:{width:"97%",position:"centered",margin:"20px"},spacing:2,children:e.jsx(k,{severity:"success",onClose:()=>F(!1),children:"Ansatt slettet!"})}),K&&e.jsx(S,{sx:{width:"97%",position:"centered",margin:"20px"},spacing:2,children:e.jsx(k,{severity:"success",onClose:()=>B(!1),children:"Opplysningene til ansatt ble endret"})}),U&&e.jsx(S,{sx:{width:"97%",position:"centered",margin:"20px"},spacing:2,children:e.jsx(k,{severity:"success",onClose:()=>w(!1),children:"Ansatt ble lagt inn"})}),e.jsxs("div",{className:"IncidentTable",children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(L,{children:[e.jsx(o,{children:e.jsx(b,{active:!0,direction:u,onClick:()=>v("firstName"),children:e.jsxs("h3",{children:[" ",c.firstName," "]})})}),e.jsx(o,{children:e.jsx(b,{active:!0,direction:u,onClick:()=>v("lastName"),children:e.jsxs("h3",{children:[" ",c.lastName," "]})})}),e.jsx(o,{children:e.jsx(b,{active:!0,direction:u,onClick:()=>v("flightNumber"),children:e.jsxs("h3",{children:[" ",c.flight," "]})})}),e.jsx(o,{children:e.jsx(b,{active:!0,direction:u,children:e.jsxs("h3",{children:[" ",c.phone," "]})})}),e.jsx(o,{})]})}),e.jsx(pe,{children:$.length>0?$.map(t=>e.jsxs(L,{component:oe,to:`/SoulInformation/${t.id}`,children:[e.jsx(o,{children:t.firstName}),e.jsx(o,{children:t.lastName}),e.jsx(o,{children:t.flightNumber}),e.jsx(o,{children:t.phone}),e.jsxs(o,{children:[e.jsx(A,{onClick:()=>q(t.id),children:e.jsx(ue,{})}),e.jsx(A,{"aria-label":"delete",color:"secondary",onClick:()=>ne(t.id),children:e.jsx(fe,{})})]})]},t.id)):e.jsx(L,{children:e.jsxs(o,{colSpan:4,children:[c.notFound,"."]})})}),E.length>j&&e.jsxs("div",{className:"Buttons",children:[e.jsx("button",{disabled:te,onClick:()=>y(p-1),children:c.previous}),e.jsxs("span",{children:[c.page,` ${p+1} av ${O}`]}),e.jsx("button",{disabled:se,onClick:()=>y(p+1),children:c.next})]})]}),e.jsxs(M,{modalHeadLine:"Endre opplysninger",isOpen:J,children:[e.jsx("h2",{}),e.jsxs("div",{className:"container",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"soul-firstName",children:"Fornavn"}),e.jsx("br",{}),e.jsx(d,{className:"input-form",id:"soul-firstName",name:"soul-firstName",type:"text",placeholder:n==null?void 0:n.person.firstName,onChange:h,inputProps:{pattern:"^([p{L}p{P}d+](s)?){2,31}$",required:!0},style:{width:"450px"}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"soul-firstName",children:"Etternavn"}),e.jsx("br",{}),e.jsx(d,{className:"input-form",id:"soul-firstName",name:"soul-firstName",type:"text",placeholder:n==null?void 0:n.person.lastName,onChange:h,inputProps:{pattern:"^([p{L}p{P}d+](s)?){2,31}$",required:!0},style:{width:"450px"}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"soul-firstName",children:"E-post"}),e.jsx("br",{}),e.jsx(d,{className:"input-form",id:"soul-firstName",name:"soul-firstName",type:"text",placeholder:n==null?void 0:n.person.email,onChange:h,inputProps:{pattern:"^([p{L}p{P}d+](s)?){2,31}$",required:!0},style:{width:"450px"}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"soul-firstName",children:"Telefon"}),e.jsx("br",{}),e.jsx(d,{className:"input-form",id:"soul-firstName",name:"soul-firstName",type:"text",placeholder:n==null?void 0:n.person.phone,onChange:h,inputProps:{pattern:"^([p{L}p{P}d+](s)?){2,31}$",required:!0},style:{width:"450px"}})]})]}),e.jsxs("div",{className:"btn-container",children:[e.jsx(g,{className:"change-btn",type:"submit",form:"ic-form__affected",variant:"contained",style:{backgroundColor:"#369E3B",width:"230px",height:"40px"},onSubmit:()=>q(n==null?void 0:n.id),children:"Endre opplysninger"}),e.jsx(g,{className:"back-btn",type:"submit",form:"ic-form__affected",variant:"contained",style:{backgroundColor:"#369E3B",width:"230px",height:"40px"},onClick:()=>I(!1),children:"Tilbake"})]})]}),e.jsx(M,{modalHeadLine:"Legg til ansatt",isOpen:Q,children:e.jsx("div",{className:"container",children:e.jsxs("form",{onSubmit:ae,children:[e.jsxs("label",{children:["First Name:",e.jsx(d,{type:"text",name:"firstName",value:l.person.firstName,onChange:h,style:{width:"450px"},required:!0})]}),e.jsxs("label",{children:["Last Name:",e.jsx(d,{type:"text",name:"lastName",value:l.person.lastName,onChange:h,style:{width:"450px"},required:!0})]}),e.jsxs("label",{children:["Email:",e.jsx(d,{type:"email",name:"email",value:l.person.email,onChange:h,style:{width:"450px"},required:!0})]}),e.jsxs("label",{children:["Phone:",e.jsx(d,{type:"tel",name:"phone",value:l.person.phone,onChange:h,style:{width:"450px"},required:!0})]}),e.jsxs("label",{children:["Flight Number:",e.jsx(d,{type:"text",name:"flightNumber",value:l.flight.flightNumber,onChange:G,style:{width:"450px"},required:!0})]}),e.jsxs("div",{className:"btn-container",children:[e.jsx(g,{type:"submit",className:"change-btn",variant:"contained",style:{backgroundColor:"#369E3B",width:"230px",height:"40px"},children:"Legg til ansatt"}),e.jsx(g,{className:"back-btn",type:"submit",variant:"contained",style:{backgroundColor:"#369E3B",width:"230px",height:"40px"},onClick:()=>N(!1),children:"Tilbake"})]})]})})})]})]})})};export{Ie as default};
