import{G as se,j as e,b as o,u as ie,C as oe,c as n,B as x,K as I,e as le,n as ce}from"./index-04fc7d56.js";import{M as $}from"./Modal-200beab9.js";/* empty css                  *//* empty css                     */import{T as de}from"./TextField-b77e99c3.js";import{S as P}from"./Stack-83892a09.js";import{A as F}from"./Alert-0bf56b7a.js";import{T as he,b as D,c as l,a as pe}from"./TableRow-ccfcb366.js";import{T as me}from"./TableHead-be2f99d0.js";import{T as y}from"./TableSortLabel-1fd7be73.js";import{E as ue,D as ge}from"./Edit-be4598f8.js";import{I as p}from"./Input-3dc7ac4d.js";import"./OutlinedInput-ed327864.js";import"./InputBase-d61b863a.js";import"./Select-2f2e7d44.js";const fe=se(e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"}),"Info"),w=10,Be=Ne=>{const[b,_]=o.useState([]),[C,S]=o.useState([]),[m,q]=o.useState("asc"),[ye,z]=o.useState(""),[g,E]=o.useState(0),[M,v]=o.useState(!1),[A,f]=o.useState(!1),[a,W]=o.useState(null),V=ie(),[s,j]=o.useState({flight:{flightNumber:"",flightId:""},person:{firstName:"",lastName:"",email:"",phone:""},type:0,isConfirmed:!1}),[H,J]=o.useState(localStorage.getItem("language")||"no"),c=H==="en"?le.soulList:ce.soulList,R=t=>{J(t),localStorage.setItem("language",t)};o.useEffect(()=>{async function t(){try{const d=(await(await fetch("https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Soul")).json()).filter(h=>h.type===0).map(h=>({id:h.id,person_FirstName:h.person.firstName,person_LastName:h.person.lastName,person_Email:h.person.email,person_Phone:h.person.phone,flightNumber:h.flight.flightNumber}));_(d)}catch(r){console.error("Error while fetching passengers data:",r)}}t()},[]),o.useEffect(()=>{b.length>0&&S(b)},[b]);const N=t=>{const r=[...C].sort((i,d)=>m==="asc"?i[t]>d[t]?1:-1:i[t]<d[t]?1:-1);S(r),q(m==="asc"?"desc":"asc")},u=t=>{const{name:r,value:i}=t.target;j(d=>({...d,person:{...d.person,[r]:i}}))},G=t=>{j(r=>({...r,flight:{...r.flight,flightNumber:t.target.value}}))},[Q,B]=o.useState(!1),[K,k]=o.useState(!1),[U,L]=o.useState(!1),O=Math.ceil(C.length/w),Z=g===0,X=g===O-1,T=C.slice(g*w,g*w+w),Y=t=>{const{value:r}=t.target;z(r),E(0);let i=[];r!==""?i=C.filter(d=>d.person_FirstName&&d.person_FirstName.toLowerCase().includes(r.toLowerCase())):i=b,S(i)},ee=async t=>{if(window.confirm("Er du sikker pÃ¥ at du vil slette passasjer?"))try{await fetch(`https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Soul/${t}`,{method:"DELETE"}),_(b.filter(i=>i.id!==t)),B(!0)}catch(i){console.error("Error while deleting soul:",i)}},te=async t=>{t.preventDefault();try{const r=s.flightNumber,h=(await(await fetch("https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Flight")).json())[0].id;console.log(h),(await fetch(`https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/flight/${h}/soul`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({person:{firstName:s.person.firstName,lastName:s.person.lastName,email:s.person.email,phone:s.person.phone},type:0,isConfirmed:!1})})).ok?(console.log("Soul added successfully"),f(!1),setTimeout(()=>{window.location.reload()},3e3),L(!0)):(console.error("Error adding Soul"),f(!1),setTimeout(()=>{window.location.reload()},3e3),L(!0))}catch(r){console.error("Error adding Soul:",r)}},ne=async t=>{t.preventDefault();try{s.person.firstName!==""&&(a.person.firstName=s.person.firstName),s.person.lastName!==""&&(a.person.lastName=s.person.lastName),s.person.email!==""&&(a.person.email=s.person.email),s.person.phone!==""&&(a.person.phone=s.person.phone),(await fetch(`https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Soul/${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({person:{firstName:a.person.firstName,lastName:a.person.lastName,email:a.person.email,phone:a.person.phone},type:a.type,isConfirmed:a.isConfirmed})})).ok?(console.log("Soul updated successfully"),v(!1),setTimeout(()=>{window.location.reload()},3e3),k(!0)):(console.error("Error editing Soul"),f(!1),setTimeout(()=>{window.location.reload()},3e3),k(!0))}catch(r){console.error("Error editing Soul:",r)}},ae=async()=>{f(!0)},re=async t=>{const r=await fetch(`https://wideroeemergencynextofkinapi.azure-api.net/WideroeEmergency/api/Soul/${t}`).then(i=>i.json());W(r),v(!0),console.log(JSON.stringify(r))};return e(oe,{navHeader:c.passengers,onLanguageChange:R,children:n("div",{className:"SearchField",children:[e(de,{label:c.searchPassengers,variant:"outlined",onChange:Y}),e(x,{className:"add-crew",onClick:()=>ae(),variant:"contained",style:{position:"absolute",top:"17%",right:"2%",width:"250px",height:"54px",margin:2,backgroundColor:"#369E3B"},sx:{":hover":{backgroundColor:"#369E3B"},margin:1},children:"Legg til passasjer"}),Q&&e(P,{sx:{width:"97%",position:"centered",margin:"20px"},spacing:2,children:e(F,{severity:"success",onClose:()=>B(!1),children:"Ansatt slettet!"})}),K&&e(P,{sx:{width:"97%",position:"centered",margin:"20px"},spacing:2,children:e(F,{severity:"success",onClose:()=>k(!1),children:"Opplysningene til ansatt ble endret"})}),U&&e(P,{sx:{width:"97%",position:"centered",margin:"20px"},spacing:2,children:e(F,{severity:"success",onClose:()=>L(!1),children:"Ansatt ble lagt inn"})}),n("div",{className:"IncidentTable",children:[n(he,{children:[e(me,{children:n(D,{children:[e(l,{children:e(y,{active:!0,direction:m,onClick:()=>N("id"),children:e("h3",{children:"Id "})})}),e(l,{children:e(y,{active:!0,direction:m,onClick:()=>N("flightNumber"),children:n("h3",{children:[" ",c.flight]})})}),e(l,{children:e(y,{active:!0,direction:m,onClick:()=>N("person_FirstName"),children:n("h3",{children:[" ",c.firstName," "]})})}),e(l,{children:e(y,{active:!0,direction:m,onClick:()=>N("person_LastName"),children:n("h3",{children:[" ",c.lastName," "]})})}),e(l,{children:e(y,{active:!0,direction:m,onClick:()=>N("person_Email"),children:n("h3",{children:[" ",c.email," "]})})}),e(l,{children:e(y,{active:!0,direction:m,onClick:()=>N("person_Phone"),children:n("h3",{children:[" ",c.phone," "]})})}),e(l,{})]})}),e(pe,{children:T.length>0?T.map(t=>n(D,{children:[e(l,{children:t.id}),e(l,{children:t.flightNumber}),e(l,{children:t.person_FirstName}),e(l,{children:t.person_LastName}),e(l,{children:t.person_Email}),e(l,{children:t.person_Phone}),n(l,{children:[e(I,{onClick:()=>re(t.id),children:e(ue,{})}),e(I,{"aria-label":"delete",color:"secondary",onClick:()=>ee(t.id),children:e(ge,{})}),e(I,{"aria-label":"detail",color:"secondary",onClick:()=>V(`/SoulInformation/${t.id}`),children:e(fe,{})})]})]},t.id)):e(D,{children:e(l,{colSpan:4,children:c.noPassengers})})}),T.length>w&&n("div",{className:"Buttons",children:[e("button",{disabled:Z,onClick:()=>E(g-1),children:c.previous}),n("span",{children:[c.page,` ${g+1} av ${O}`]}),e("button",{disabled:X,onClick:()=>E(g+1),children:c.next})]})]}),n($,{className:"my-modal",modalHeadLine:"Endre opplysninger",isOpen:M,onClose:()=>v(!1),children:[e("h2",{}),n("form",{onSubmit:ne,children:[n("div",{className:"container",children:[n("div",{children:[e("label",{htmlFor:"firstName",children:"Fornavn"}),e("br",{}),e(p,{className:"input-form",name:"firstName",type:"text",defaultValue:a==null?void 0:a.person.firstName,onChange:u,pattern:"^([\\p{L}\\p{P}\\d+](\\s)?){2,31}$",maxLength:31,style:{width:"450px"},required:!0})]}),n("div",{children:[e("label",{htmlFor:"lastName",children:"Etternavn"}),e("br",{}),e(p,{className:"input-form",name:"lastName",type:"text",defaultValue:a==null?void 0:a.person.lastName,onChange:u,maxLength:31,style:{width:"450px"},required:!0})]}),n("div",{children:[e("label",{htmlFor:"email",children:"E-post"}),e("br",{}),e(p,{className:"input-form",name:"email",type:"text",defaultValue:a==null?void 0:a.person.email,onChange:u,pattern:"^([\\p{L}\\p{P}\\d+](\\s)?){2,31}$",maxLength:31,style:{width:"450px"},required:!0})]}),n("div",{children:[e("label",{htmlFor:"phone",children:"Telefon"}),e("br",{}),e(p,{className:"input-form",name:"phone",type:"text",defaultValue:a==null?void 0:a.person.phone,onChange:u,pattern:"^([\\p{L}\\p{P}\\d+](\\s)?){2,31}$",maxLength:31,style:{width:"450px"},required:!0})]})]}),n("div",{className:"btn-container",children:[e(x,{className:"change-btn",type:"submit",variant:"contained",style:{backgroundColor:"#369E3B",width:"230px",height:"40px"},children:"Endre opplysninger"}),e(x,{className:"back-btn",type:"submit",variant:"contained",style:{backgroundColor:"#369E3B",width:"230px",height:"40px"},onClick:()=>v(!1),children:"Tilbake"})]})]})]}),e($,{className:"my-modal",modalHeadLine:"Legg til passasjer",isOpen:A,onClose:()=>f(!1),children:e("div",{className:"container",children:n("form",{onSubmit:te,children:[n("label",{children:["First Name:",e(p,{type:"text",name:"firstName",value:s.person.firstName,onChange:u,maxLength:31,style:{width:"450px"},required:!0})]}),n("label",{children:["Last Name:",e(p,{type:"text",name:"lastName",value:s.person.lastName,onChange:u,maxLength:31,style:{width:"450px"},required:!0})]}),n("label",{children:["Email:",e(p,{type:"email",name:"email",value:s.person.email,onChange:u,maxLength:31,style:{width:"450px"},required:!0})]}),n("label",{children:["Phone:",e(p,{type:"tel",name:"phone",value:s.person.phone,onChange:u,maxLength:31,style:{width:"450px"},required:!0})]}),n("label",{children:["Flight Number:",e(p,{type:"text",name:"flightNumber",value:s.flight.flightNumber,onChange:G,maxLength:31,style:{width:"450px"},required:!0})]}),n("div",{className:"btn-container",children:[e(x,{type:"submit",className:"change-btn",variant:"contained",style:{backgroundColor:"#369E3B",width:"230px",height:"40px"},children:"Legg til ansatt"}),e(x,{className:"back-btn",type:"submit",variant:"contained",style:{backgroundColor:"#369E3B",width:"230px",height:"40px"},onClick:()=>f(!1),children:"Tilbake"})]})]})})})]})]})})};export{Be as default};
